{"version":3,"sources":["react-editor.js","components/Item.js","index.js","pages/Home.js","pages/Basic.js","components/Text.js","components/List.js"],"names":["context","inEditor","EditorContextHelper","setContextProp","prop","key","value","console","error","EditablePage","props","testRef","React","createRef","myRef","refresh","log","this","node","content","commentClose","commentOpen","TemplateAnnotations","getPageCommentString","templateDefinition","parentNode","insertBefore","document","createComment","nextSibling","insertComments","DOMNode","config","templateDefinitions","component","componentMappings","getComponentMapping","ref","createElement","PureComponent","Item","title","main","header","metadata","parentTemplateId","text","list","item","App","state","pathname","window","location","fetch","replace","RegExp","pagesRes","json","page","templateDefinitionsRes","headerRes","setState","Component","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.b9f799c7.chunk.js","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { EditorContextHelper, TemplateAnnotations } from '@magnolia/template-annotations';\n\nconst context = {};\nconst inEditor = EditorContextHelper.inEditor();\n\nfunction insertComments(node, content, commentClose) {\n  console.log(inEditor);\n  console.log(node);\n\n  if (inEditor && node) {\n    const commentOpen = TemplateAnnotations.getPageCommentString(content, context.templateDefinition);\n\n    console.log(commentOpen);\n\n    if (commentOpen) {\n      node.parentNode.insertBefore(document.createComment(commentOpen), node);\n      node.parentNode.insertBefore(document.createComment(commentClose), node.nextSibling);\n    }\n  }\n}\n\nfunction setContextProp(prop) {\n  const { key, value } = prop;\n\n  if (!value) return console.error('Missing prop: ' + key);\n\n  context[key] = value;\n}\n\nfunction getComponentMapping(node) {\n  const key = node['mgnl:template'];\n  const value = context.config.componentMappings[key];\n\n  return value ? value : console.error('Missing component mapping for: ' + key);\n}\n\nclass EditablePage extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.testRef = React.createRef();\n    this.myRef = React.createRef();\n  }\n\n  componentDidUpdate() {\n    EditorContextHelper.refresh();\n  }\n\n  componentDidMount() {\n    console.log(this);\n\n    insertComments(this.DOMNode, this.props.content, '/cms:page');\n  }\n\n  render() {\n    const { content = {}, config, templateDefinitions } = this.props;\n\n    setContextProp({ key: 'config', value: config });\n\n    if (inEditor) setContextProp({ key: 'templateDefinitions', value: templateDefinitions });\n\n    const component = getComponentMapping(content);\n\n    console.log(content);\n\n    content.ref = this.testRef;\n\n    return component ? React.createElement(component, { ...content, ref: this.myRef }) : null;\n  }\n}\n\nexport { EditablePage };\n","import React from 'react';\n\nfunction Item(props) {\n  return <li>{props.item}</li>;\n}\n\nexport default Item;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n// import { EditableArea, EditorContextHelper } from '@magnolia/react-editor';\nimport { EditorContextHelper } from '@magnolia/template-annotations';\nimport { EditablePage } from './react-editor';\nimport Home from './pages/Home';\nimport Basic from './pages/Basic';\nimport Text from './components/Text';\nimport List from './components/List';\nimport Item from './components/Item';\n\nconst nodeName = 'spa-home';\nconst config = {\n  componentMappings: {\n    'spa-lm:pages/Home': Home,\n    'spa-lm:pages/Basic': Basic,\n    'spa-lm:components/Text': Text,\n    'spa-lm:components/List': List,\n    'spa-lm:components/Item': Item,\n  },\n};\n\nclass App extends React.Component {\n  state = {};\n\n  async componentDidMount() {\n    const pathname = window.location.pathname;\n    let templateDefinitions;\n    let header;\n    const pagesRes = await fetch(\n      '/magnoliaAuthor/.rest/delivery/pages/' +\n        nodeName +\n        pathname.replace(new RegExp('(.*' + nodeName + '|.html)', 'g'), '')\n    );\n    const page = await pagesRes.json();\n\n    if (EditorContextHelper.inEditor()) {\n      const templateDefinitionsRes = await fetch(\n        '/magnoliaAuthor/.rest/templateDefinition/v1/' + page['mgnl:template']\n      );\n\n      templateDefinitions = await templateDefinitionsRes.json();\n    }\n\n    if (pathname !== '/magnoliaAuthor/' + nodeName + '.html') {\n      const headerRes = await fetch('/magnoliaAuthor/.rest/delivery/pages/' + nodeName + '/header');\n\n      header = await headerRes.json();\n    }\n\n    this.setState({ page, templateDefinitions, header });\n  }\n\n  render() {\n    const { page, templateDefinitions, header } = this.state;\n\n    return (\n      <div>\n        {/* {header && <EditableArea content={header} />} */}\n        {page && config && <EditablePage content={page} config={config} templateDefinitions={templateDefinitions} />}\n      </div>\n    );\n  }\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","import React from 'react';\nimport { EditableArea } from '@magnolia/react-editor';\n\nfunction Home(props) {\n  const { title, main, header, metadata } = props;\n\n  return (\n    <div>\n      <h1>{title}</h1>\n      {/* {header && <EditableArea content={header} parentTemplateId={metadata['mgnl:template']} />}\n      {main && <EditableArea content={main} parentTemplateId={metadata['mgnl:template']} />} */}\n    </div>\n  );\n}\n\nexport default Home;\n","import React from 'react';\nimport { EditableArea } from '@magnolia/react-editor';\n\nfunction Basic(props) {\n  const { title, main, metadata } = props;\n\n  return (\n    <div>\n      <h1>{title}</h1>\n      {main && <EditableArea content={main} parentTemplateId={metadata['mgnl:template']} />}\n    </div>\n  );\n}\n\nexport default Basic;\n","import React from 'react';\n\nfunction Text(props) {\n  return <div>{props.text}</div>;\n}\n\nexport default Text;\n","import React from 'react';\nimport { EditableArea } from '@magnolia/react-editor';\n\nfunction List(props) {\n  const { list, metadata } = props;\n\n  return <ul>{list && <EditableArea content={list} parentTemplateId={metadata['mgnl:template']} />}</ul>;\n}\n\nexport default List;\n"],"sourceRoot":""}